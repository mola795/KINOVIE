<%= render 'shared/carousel' %>
<div class="container">
  <div class="row container-row">
    <div class="col-7">
      <div id="carouselItemCards" class="carousel carousel-cards slide">
        <h2 class="container page-heading">Friend's Favorite Movies</h2>
        <div class="carousel-inner carousel-card-inner">
          <% if user_signed_in? %>
            <% @titles.where(media_type: "movie").each_slice(4).each_with_index do |group, index| %>
              <div class="carousel-item <%= index == 0 ? "active" : "" %>">
                <div class="item-card-list">
                  <% group.each do |title| %>
                    <%= render 'shared/item_card', title: title %>
                  <% end %>
                </div>
              </div>
            <% end %>
          <% else %>
            <% @titles.each_slice(6).each_with_index do |group, index| %>
              <div class="carousel-item <%= index == 0 ? "active" : "" %>">
                <div class="item-card-list">
                  <% group.each do |title| %>
                    <%= render 'shared/item_card', title: title %>
                  <% end %>
                </div>
              </div>
            <% end %>
          <% end %>
        </div>
        <button class="carousel-control-prev" type="button" data-bs-target="#carouselItemCards" data-bs-slide="prev">
          <span class="carousel-control-prev-icon" aria-hidden="true"></span>
          <span class="visually-hidden">Previous</span>
        </button>
        <button class="carousel-control-next" type="button" data-bs-target="#carouselItemCards" data-bs-slide="next">
          <span class="carousel-control-next-icon" aria-hidden="true"></span>
          <span class="visually-hidden">Next</span>
        </button>
      </div>
      <div id="carouselTVShowItemCards" class="carousel carousel-cards slide">
        <h2 class="page-heading">Friend's Favorite TV Shows</h2>
        <div class="carousel-inner carousel-card-inner">
          <% @titles.where(media_type: "tv").each_slice(4).each_with_index do |group, index| %>
            <div class="carousel-item <%= index == 0 ? "active" : "" %>">
              <div class="item-card-list">
                <% group.each do |title| %>
                  <%= render 'shared/item_card', title: title %>
                <% end %>
              </div>
            </div>
          <% end %>
        </div>
        <button class="carousel-control-prev" type="button" data-bs-target="#carouselTVShowItemCards" data-bs-slide="prev">
          <span class="carousel-control-prev-icon" aria-hidden="true"></span>
          <span class="visually-hidden">Previous</span>
        </button>
        <button class="carousel-control-next" type="button" data-bs-target="#carouselTVShowItemCards" data-bs-slide="next">
          <span class="carousel-control-next-icon" aria-hidden="true"></span>
          <span class="visually-hidden">Next</span>
        </button>
      </div>
      <div id="carouselCoverCards" class="carousel carousel-cards slide">
        <h2 class="container page-heading">Friend's Favorite Genres</h2>
        <div class="carousel-inner carousel-card-inner">
          <% @genres.each_slice(3).each_with_index do |group, index| %>
            <div class="carousel-item <%= index == 0 ? "active" : "" %>">
              <div class="cover-card-list">
                <% group.each do |genre| %>
                  <%= render 'shared/cover_card', genre: genre %>
                <% end %>
              </div>
            </div>
          <% end %>
        </div>
        <button class="carousel-control-prev" type="button" data-bs-target="#carouselCoverCards" data-bs-slide="prev">
          <span class="carousel-control-prev-icon" aria-hidden="true"></span>
          <span class="visually-hidden">Previous</span>
        </button>
        <button class="carousel-control-next" type="button" data-bs-target="#carouselCoverCards" data-bs-slide="next">
          <span class="carousel-control-next-icon" aria-hidden="true"></span>
          <span class="visually-hidden">Next</span>
        </button>
      </div>
      <div id="carouselCollection" class="carousel carousel-cards slide">
        <h2 class="page-heading">Friend's List</h2>
        <div class="carousel-inner carousel-card-inner">
          <% @lists.each_slice(2).each_with_index do |group, index| %>
            <div class="carousel-item <%= index == 0 ? "active" : "" %>">
              <div class="collection-card-list">
                <% group.each do |list| %>
                  <%= render 'shared/collection_card', list: list %>
                <% end %>
              </div>
            </div>
          <% end %>
        </div>
        <button class="carousel-control-prev" type="button" data-bs-target="#carouselCollection" data-bs-slide="prev">
          <span class="carousel-control-prev-icon" aria-hidden="true"></span>
          <span class="visually-hidden">Previous</span>
        </button>
        <button class="carousel-control-next" type="button" data-bs-target="#carouselCollection" data-bs-slide="next">
          <span class="carousel-control-next-icon" aria-hidden="true"></span>
          <span class="visually-hidden">Next</span>
        </button>
      </div>
    </div>
    <% if user_signed_in? %>
      <div class="col">
        <h2 class="container page-heading">Friend's Activity</h2>
        <div class="container-activity-feed">
          <%= render 'shared/activity_feed', list_activity: @friends_activity, title: "" %>
        </div>
      </div>
    <% end %>
  </div>
</div>
